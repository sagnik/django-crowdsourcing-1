{"Caption":"Figure 6: Exploits generated against known vulnerabilities in some real-world software packages.","ImageText":[{"Text":"Sl.no.","TextBB":[88.5889,245.079,111.196,253.796],"Rotation":0},{"Text":"Software","TextBB":[155.758,245.079,190.628,253.796],"Rotation":0},{"Text":"(1)","TextBB":[94.2458,267.772,105.54,276.489],"Rotation":0},{"Text":"php-3.0.16","TextBB":[134.857,268.295,192.974,275.908],"Rotation":0},{"Text":"[12]","TextBB":[195.393,267.772,211.53,276.489],"Rotation":0},{"Text":"(2)","TextBB":[94.2458,291.35,105.54,300.067],"Rotation":0},{"Text":"(3)","TextBB":[94.2458,302.973,105.54,311.691],"Rotation":0},{"Text":"qpopper-2.53","TextBB":[129.046,291.873,198.786,299.486],"Rotation":0},{"Text":"[31]","TextBB":[201.206,291.35,217.342,300.067],"Rotation":0},{"Text":"wu-ftpd-2.6.0","TextBB":[126.139,303.496,201.691,311.11],"Rotation":0},{"Text":"[37]","TextBB":[204.111,302.973,220.248,311.691],"Rotation":0},{"Text":"DIS","TextBB":[238.96,245.079,254.564,253.796],"Rotation":0},{"Text":"LEN","TextBB":[270.05,245.079,288.88,253.796],"Rotation":0},{"Text":"Exploit","TextBB":[303.824,245.079,332.349,253.796],"Rotation":0},{"Text":"24","TextBB":[244.878,267.772,254.564,276.489],"Rotation":0},{"Text":"1024","TextBB":[269.507,267.772,288.879,276.489],"Rotation":0},{"Text":"2120","TextBB":[235.192,291.35,254.564,300.067],"Rotation":0},{"Text":"9364","TextBB":[235.192,302.973,254.564,311.691],"Rotation":0},{"Text":"1024","TextBB":[269.507,291.35,288.879,300.067],"Rotation":0},{"Text":"4096","TextBB":[269.507,302.973,288.879,311.691],"Rotation":0},{"Text":"Write","TextBB":[303.824,267.772,325.879,276.489],"Rotation":0},{"Text":"0xbfff8cc3","TextBB":[328.299,268.295,386.415,275.908],"Rotation":0},{"Text":"to","TextBB":[388.836,267.772,396.372,276.489],"Rotation":0},{"Text":"0xbfff88c3","TextBB":[398.793,268.295,456.91,275.908],"Rotation":0},{"Text":"(a","TextBB":[459.329,267.772,468.56,276.489],"Rotation":0},{"Text":"4","TextBB":[468.557,270.97,473.268,277.113],"Rotation":0},{"Text":"a","TextBB":[473.957,267.665,479.962,276.267],"Rotation":0},{"Text":"3","TextBB":[479.96,270.97,484.671,277.113],"Rotation":0},{"Text":"a","TextBB":[485.36,267.665,491.365,276.267],"Rotation":0},{"Text":"2","TextBB":[491.361,270.97,496.072,277.113],"Rotation":0},{"Text":"a","TextBB":[496.763,267.665,502.768,276.267],"Rotation":0},{"Text":"1","TextBB":[502.764,270.97,507.475,277.113],"Rotation":0},{"Text":")","TextBB":[508.164,267.772,511.389,276.489],"Rotation":0},{"Text":"Assume","TextBB":[303.824,278.841,335.032,287.559],"Rotation":0},{"Text":"that","TextBB":[337.454,278.841,351.983,287.559],"Rotation":0},{"Text":"b","TextBB":[354.401,278.735,359.264,287.336],"Rotation":0},{"Text":"4","TextBB":[359.268,282.039,363.979,288.182],"Rotation":0},{"Text":"b","TextBB":[364.668,278.735,369.53,287.336],"Rotation":0},{"Text":"3","TextBB":[369.535,282.039,374.246,288.182],"Rotation":0},{"Text":"b","TextBB":[374.935,278.735,379.797,287.336],"Rotation":0},{"Text":"2","TextBB":[379.801,282.039,384.513,288.182],"Rotation":0},{"Text":"b","TextBB":[385.201,278.735,390.064,287.336],"Rotation":0},{"Text":"1","TextBB":[390.067,282.039,394.778,288.182],"Rotation":0},{"Text":"=","TextBB":[397.889,278.841,403.352,287.559],"Rotation":0},{"Text":"a","TextBB":[405.774,278.735,411.779,287.336],"Rotation":0},{"Text":"4","TextBB":[411.775,282.039,416.486,288.182],"Rotation":0},{"Text":"a","TextBB":[417.175,278.735,423.18,287.336],"Rotation":0},{"Text":"3","TextBB":[423.178,282.039,427.889,288.182],"Rotation":0},{"Text":"a","TextBB":[428.578,278.735,434.583,287.336],"Rotation":0},{"Text":"2","TextBB":[434.579,282.039,439.29,288.182],"Rotation":0},{"Text":"a","TextBB":[439.981,278.735,445.986,287.336],"Rotation":0},{"Text":"1","TextBB":[445.982,282.039,450.693,288.182],"Rotation":0},{"Text":"+","TextBB":[453.903,278.735,462.397,287.336],"Rotation":0},{"Text":"2.","TextBB":[464.916,278.735,472.853,287.336],"Rotation":0},{"Text":"Read","TextBB":[303.824,291.35,323.729,300.067],"Rotation":0},{"Text":"contents","TextBB":[326.15,291.35,358.434,300.067],"Rotation":0},{"Text":"at","TextBB":[360.855,291.35,367.849,300.067],"Rotation":0},{"Text":"0xbfff88c3","TextBB":[370.268,291.873,428.385,299.486],"Rotation":0},{"Text":"(a","TextBB":[430.804,291.35,440.035,300.067],"Rotation":0},{"Text":"4","TextBB":[440.032,294.549,444.743,300.692],"Rotation":0},{"Text":"a","TextBB":[445.432,291.243,451.437,299.844],"Rotation":0},{"Text":"3","TextBB":[451.433,294.549,456.145,300.692],"Rotation":0},{"Text":"a","TextBB":[456.835,291.243,462.84,299.844],"Rotation":0},{"Text":"2","TextBB":[462.836,294.549,467.547,300.692],"Rotation":0},{"Text":"a","TextBB":[468.236,291.243,474.242,299.844],"Rotation":0},{"Text":"1","TextBB":[474.239,294.549,478.95,300.692],"Rotation":0},{"Text":")","TextBB":[479.639,291.35,482.864,300.067],"Rotation":0},{"Text":"Write","TextBB":[303.824,302.973,325.879,311.691],"Rotation":0},{"Text":"0xbfffbcab","TextBB":[328.299,303.496,386.415,311.11],"Rotation":0},{"Text":"to","TextBB":[388.836,302.973,396.372,311.691],"Rotation":0},{"Text":"0xbfff88c3","TextBB":[398.793,303.496,456.91,311.11],"Rotation":0},{"Text":"(a","TextBB":[459.329,302.973,468.56,311.691],"Rotation":0},{"Text":"4","TextBB":[468.557,306.171,473.268,312.314],"Rotation":0},{"Text":"a","TextBB":[473.957,302.867,479.962,311.468],"Rotation":0},{"Text":"3","TextBB":[479.96,306.171,484.671,312.314],"Rotation":0},{"Text":"a","TextBB":[485.36,302.867,491.365,311.468],"Rotation":0},{"Text":"2","TextBB":[491.361,306.171,496.072,312.314],"Rotation":0},{"Text":"a","TextBB":[496.763,302.867,502.768,311.468],"Rotation":0},{"Text":"1","TextBB":[502.764,306.171,507.475,312.314],"Rotation":0},{"Text":")","TextBB":[508.164,302.973,511.389,311.691],"Rotation":0},{"Text":"Assume","TextBB":[303.824,314.929,335.032,323.646],"Rotation":0},{"Text":"that","TextBB":[337.454,314.929,351.983,323.646],"Rotation":0},{"Text":"b","TextBB":[354.401,314.822,359.264,323.424],"Rotation":0},{"Text":"4","TextBB":[359.268,318.127,363.979,324.27],"Rotation":0},{"Text":"b","TextBB":[364.668,314.822,369.53,323.424],"Rotation":0},{"Text":"3","TextBB":[369.535,318.127,374.246,324.27],"Rotation":0},{"Text":"b","TextBB":[374.935,314.822,379.797,323.424],"Rotation":0},{"Text":"2","TextBB":[379.801,318.127,384.513,324.27],"Rotation":0},{"Text":"b","TextBB":[385.201,314.822,390.064,323.424],"Rotation":0},{"Text":"1","TextBB":[390.067,318.127,394.778,324.27],"Rotation":0},{"Text":"=","TextBB":[397.889,314.929,403.352,323.646],"Rotation":0},{"Text":"a","TextBB":[405.774,314.822,411.779,323.424],"Rotation":0},{"Text":"4","TextBB":[411.775,318.127,416.486,324.27],"Rotation":0},{"Text":"a","TextBB":[417.175,314.822,423.18,323.424],"Rotation":0},{"Text":"3","TextBB":[423.178,318.127,427.889,324.27],"Rotation":0},{"Text":"a","TextBB":[428.578,314.822,434.583,323.424],"Rotation":0},{"Text":"2","TextBB":[434.579,318.127,439.29,324.27],"Rotation":0},{"Text":"a","TextBB":[439.981,314.822,445.986,323.424],"Rotation":0},{"Text":"1","TextBB":[445.982,318.127,450.693,324.27],"Rotation":0},{"Text":"+","TextBB":[453.903,314.822,462.397,323.424],"Rotation":0},{"Text":"2.","TextBB":[464.916,314.822,472.853,323.424],"Rotation":0},{"Text":"Exploit","TextBB":[593.735,245.079,622.26,253.796],"Rotation":0},{"Text":"string","TextBB":[624.682,245.079,646.747,253.796],"Rotation":0},{"Text":"discovered","TextBB":[649.168,245.079,690.838,253.796],"Rotation":0},{"Text":"(\"?\"","TextBB":[541.911,256.148,562.571,264.866],"Rotation":0},{"Text":"represents","TextBB":[564.992,256.148,604.259,264.866],"Rotation":0},{"Text":"a","TextBB":[606.681,256.148,610.981,264.866],"Rotation":0},{"Text":"non-zero","TextBB":[613.403,256.148,647.827,264.866],"Rotation":0},{"Text":"non-%","TextBB":[650.249,256.148,673.812,264.866],"Rotation":0},{"Text":"ASCII","TextBB":[676.233,256.148,701.524,264.866],"Rotation":0},{"Text":"character)","TextBB":[703.945,256.148,742.661,264.866],"Rotation":0},{"Text":"\"a","TextBB":[566.14,268.295,577.957,275.908],"Rotation":0},{"Text":"1","TextBB":[577.953,270.97,582.664,277.113],"Rotation":0},{"Text":"a","TextBB":[583.354,267.665,589.36,276.267],"Rotation":0},{"Text":"2","TextBB":[589.356,270.97,594.067,277.113],"Rotation":0},{"Text":"a","TextBB":[594.756,267.665,600.761,276.267],"Rotation":0},{"Text":"3","TextBB":[600.758,270.97,605.47,277.113],"Rotation":0},{"Text":"a","TextBB":[606.158,267.665,612.164,276.267],"Rotation":0},{"Text":"4","TextBB":[612.16,270.97,616.871,277.113],"Rotation":0},{"Text":"%36000Lg%31Lg%n\"","TextBB":[617.561,268.295,710.548,275.908],"Rotation":0},{"Text":"+","TextBB":[712.967,267.772,718.43,276.489],"Rotation":0},{"Text":"\"?b","TextBB":[569.449,279.364,585.933,286.978],"Rotation":0},{"Text":"1","TextBB":[585.938,282.039,590.649,288.182],"Rotation":0},{"Text":"b","TextBB":[591.338,278.735,596.2,287.336],"Rotation":0},{"Text":"2","TextBB":[596.204,282.039,600.915,288.182],"Rotation":0},{"Text":"b","TextBB":[601.604,278.735,606.467,287.336],"Rotation":0},{"Text":"3","TextBB":[606.469,282.039,611.181,288.182],"Rotation":0},{"Text":"b","TextBB":[611.871,278.735,616.733,287.336],"Rotation":0},{"Text":"4","TextBB":[616.736,282.039,621.447,288.182],"Rotation":0},{"Text":"%13000Lg%111g%n\"","TextBB":[622.136,279.364,715.123,286.978],"Rotation":0},{"Text":"(\"%Lg\")","TextBB":[526.333,291.35,561.842,300.067],"Rotation":0},{"Text":"240","TextBB":[561.842,288.989,575.968,295.132],"Rotation":0},{"Text":"+","TextBB":[579.081,291.35,584.544,300.067],"Rotation":0},{"Text":"(\"?\")","TextBB":[586.965,291.35,610.85,300.067],"Rotation":0},{"Text":"52","TextBB":[610.85,288.989,620.272,295.132],"Rotation":0},{"Text":"+","TextBB":[623.381,291.35,628.844,300.067],"Rotation":0},{"Text":"\"%Ld%Ld%d%d%sa","TextBB":[631.265,291.873,712.821,299.486],"Rotation":0},{"Text":"1","TextBB":[712.817,294.549,717.528,300.692],"Rotation":0},{"Text":"a","TextBB":[718.217,291.243,724.222,299.844],"Rotation":0},{"Text":"2","TextBB":[724.219,294.549,728.931,300.692],"Rotation":0},{"Text":"a","TextBB":[729.619,291.243,735.625,299.844],"Rotation":0},{"Text":"3","TextBB":[735.621,294.549,740.332,300.692],"Rotation":0},{"Text":"a","TextBB":[741.022,291.243,747.028,299.844],"Rotation":0},{"Text":"4","TextBB":[747.024,294.549,751.735,300.692],"Rotation":0},{"Text":"\"","TextBB":[752.424,291.873,758.235,299.486],"Rotation":0},{"Text":"\"a","TextBB":[577.571,303.496,589.387,311.11],"Rotation":0},{"Text":"1","TextBB":[589.385,306.171,594.096,312.314],"Rotation":0},{"Text":"a","TextBB":[594.785,302.867,600.79,311.468],"Rotation":0},{"Text":"2","TextBB":[600.786,306.171,605.497,312.314],"Rotation":0},{"Text":"a","TextBB":[606.186,302.867,612.192,311.468],"Rotation":0},{"Text":"3","TextBB":[612.189,306.171,616.9,312.314],"Rotation":0},{"Text":"a","TextBB":[617.589,302.867,623.594,311.468],"Rotation":0},{"Text":"4","TextBB":[623.592,306.171,628.303,312.314],"Rotation":0},{"Text":"%99gb","TextBB":[628.992,303.496,657.1,311.11],"Rotation":0},{"Text":"1","TextBB":[657.104,306.171,661.815,312.314],"Rotation":0},{"Text":"b","TextBB":[662.504,302.867,667.367,311.468],"Rotation":0},{"Text":"2","TextBB":[667.369,306.171,672.081,312.314],"Rotation":0},{"Text":"b","TextBB":[672.771,302.867,677.633,311.468],"Rotation":0},{"Text":"3","TextBB":[677.636,306.171,682.347,312.314],"Rotation":0},{"Text":"b","TextBB":[683.036,302.867,687.899,311.468],"Rotation":0},{"Text":"4","TextBB":[687.903,306.171,692.614,312.314],"Rotation":0},{"Text":"\"","TextBB":[693.303,303.496,699.114,311.11],"Rotation":0},{"Text":"+","TextBB":[701.536,302.973,706.999,311.691],"Rotation":0},{"Text":"(\"%60Lg\")","TextBB":[542.231,314.929,589.362,323.646],"Rotation":0},{"Text":"778","TextBB":[589.363,312.567,603.489,318.71],"Rotation":0},{"Text":"+","TextBB":[606.601,314.929,612.064,323.646],"Rotation":0},{"Text":"\"%912g%600Lg%n%852X%n\"","TextBB":[614.485,315.452,742.341,323.065],"Rotation":0}],"Mention":["qualifiers [18] to identify \u201Ctainted\u201D (i.e., user-controlled) inputs that\ncould potentially be used as format-strings. We report on two ex-\nperiments here: the first showing how we can reduce the false alarm\nrate, and the second showing how we can confirm a true vulnera-\nbility by generating an exploit.\nConsider the program in Figure 2. When compiled on our ma-\nchine, the value of DIS is 28 bytes. Irrespective of the value of\nLEN, the size of the buffer fmt, Percent-S reports that the printf\nstatement on line (5) is exploitable. Clearly, small values of LEN\npreclude the possibility of attack. As a result, Percent-S produces\nfalse alarms, because it does not account for the values of the pa-\nrameters DIS and LEN.\nOn the other hand, using our model of printf, we were able\nto infer that a read-exploit (similar to the one reported earlier) is\nnot possible unless LEN is at least 15 bytes, and a write-exploit\n(to write the integer 234) is not possible unless LEN is at least\n20 bytes. In each of these cases, our analysis produces a format-\nstring that demonstrates the exploit, while Percent-S does not.\nWe also used the tool to analyze known format-string vulner-\nabilities real-world software packages; Figure 6 has the details.\nphp-3.0.16 is a language-processor for the widely-used web-\nscripting language php, qpopper-2.53 is a POP3 mail server,\nand wu-ftpd-2.6.0 is a popular file-transfer daemon. We ex-\nplain in detail the exploit against wu-ftpd-2.6.0; the others are\nsimilar. Percent-S correctly identified the location of the vulnera-\nbility in wu-ftpd-2.6.0, but did not produce a format-string\ndemonstrating the exploit. The value of DIS and LEN for this ex-\nample were 9364 and 4096, respectively, which we obtained by\ndisassembling the binary executable. For these values of DIS and\nLEN, we checked whether the attacker could perform the following\nexploit: The attacker uses the buffer that stores the format-string\nto additionally store malicious code, and then overwrites the re-\nturn address in the stack frame of printf using a write exploit\n(Section 4.3) so as to point to the beginning of the malicious code\nsequence instead. We assumed that the return address to be over-\nwritten is at the stack location 0xbfff88c3, and that the malicious\ncode is located at the address 0xbfffbcab, 13288 bytes above\n(and hence located within the buffer that stores the format-string).\nThese address values are easily read off the stack using another ex-\nploit, as explained in Section 4.1. Because the value to be written\nis fairly large, we used a variant of the predicate Bad that allows\nfor writing to a single address using multiple, slightly misaligned\nwrites of smaller values. (Details on doing such misaligned writes\ncan be found in [30, 37].)\n"],"Page":7,"Number":6,"Type":"Figure","CaptionBB":[163,330,682,343],"Height":1100,"Width":850,"DPI":100,"ImageBB":[79,241,768,328]}