{"Caption":"Figure 4: The predicate Bad used for (A) Read exploit and (B) Write exploit. ","ImageText":[{"Text":"(A)","TextBB":[108.062,77.7899,121.507,86.5074],"Rotation":0},{"Text":"Bad","TextBB":[123.928,78.313,141.363,85.9263],"Rotation":0},{"Text":"for","TextBB":[143.783,77.7899,155.077,86.5074],"Rotation":0},{"Text":"Read","TextBB":[157.499,77.7899,177.404,86.5074],"Rotation":0},{"Text":"Exploit","TextBB":[179.825,77.7899,208.351,86.5074],"Rotation":0},{"Text":"[","TextBB":[82.9667,90.9931,86.0953,99.5944],"Rotation":0},{"Text":"FMTPTR","TextBB":[86.3403,92.423,118.869,99.3967],"Rotation":0},{"Text":"<","TextBB":[122.257,90.9931,130.907,99.5944],"Rotation":0},{"Text":"DIS","TextBB":[134.297,91.0997,150.87,99.8172],"Rotation":0},{"Text":"+","TextBB":[153.776,91.0997,159.239,99.8172],"Rotation":0},{"Text":"(LEN","TextBB":[162.145,91.0997,185.653,99.8172],"Rotation":0},{"Text":"−","TextBB":[188.315,90.4507,196.965,99.5944],"Rotation":0},{"Text":"1)","TextBB":[199.626,91.0997,208.179,99.8172],"Rotation":0},{"Text":"−","TextBB":[210.843,90.4507,219.493,99.5944],"Rotation":0},{"Text":"1]","TextBB":[222.154,91.0997,230.369,99.8172],"Rotation":0},{"Text":"∧","TextBB":[82.9667,101.52,90.425,110.664],"Rotation":0},{"Text":"[","TextBB":[92.8444,102.063,95.9731,110.664],"Rotation":0},{"Text":"ARGPTR","TextBB":[96.2194,103.492,129.174,110.466],"Rotation":0},{"Text":">","TextBB":[132.561,102.063,141.211,110.664],"Rotation":0},{"Text":"DIS]","TextBB":[144.601,102.169,164.545,110.887],"Rotation":0},{"Text":"∧","TextBB":[82.9667,112.59,90.425,121.733],"Rotation":0},{"Text":"[","TextBB":[92.8444,113.132,95.9731,121.733],"Rotation":0},{"Text":"ARGPTR","TextBB":[96.2194,114.562,129.174,121.536],"Rotation":0},{"Text":"<","TextBB":[132.561,113.132,141.211,121.733],"Rotation":0},{"Text":"DIS","TextBB":[144.601,113.239,161.174,121.956],"Rotation":0},{"Text":"+","TextBB":[164.08,113.239,169.543,121.956],"Rotation":0},{"Text":"(LEN","TextBB":[172.449,113.239,195.957,121.956],"Rotation":0},{"Text":"−","TextBB":[198.619,112.59,207.269,121.733],"Rotation":0},{"Text":"1)","TextBB":[209.931,113.239,218.483,121.956],"Rotation":0},{"Text":"−","TextBB":[221.147,112.59,229.797,121.733],"Rotation":0},{"Text":"4]","TextBB":[232.46,113.239,240.673,121.956],"Rotation":0},{"Text":"∧","TextBB":[82.9667,123.66,90.425,132.804],"Rotation":0},{"Text":"[∗","TextBB":[92.8444,124.203,101.643,132.804],"Rotation":0},{"Text":"FMTPTR","TextBB":[101.889,125.633,134.418,132.606],"Rotation":0},{"Text":"=","TextBB":[137.804,124.203,146.299,132.804],"Rotation":0},{"Text":"\u2018%\u2019]","TextBB":[149.449,124.832,170.012,132.446],"Rotation":0},{"Text":"∧","TextBB":[82.9667,134.73,90.425,143.874],"Rotation":0},{"Text":"[∗(","TextBB":[92.8444,135.272,105.966,143.874],"Rotation":0},{"Text":"FMTPTR","TextBB":[106.212,136.702,138.741,143.676],"Rotation":0},{"Text":"+","TextBB":[141.499,135.272,149.993,143.874],"Rotation":0},{"Text":"1)","TextBB":[152.512,135.272,162.353,143.874],"Rotation":0},{"Text":"=","TextBB":[165.501,135.272,173.996,143.874],"Rotation":0},{"Text":"\u2018s\u2019]","TextBB":[177.146,135.902,197.709,143.515],"Rotation":0},{"Text":"∧","TextBB":[82.9667,145.799,90.425,154.943],"Rotation":0},{"Text":"[∗","TextBB":[92.8444,146.342,101.643,154.943],"Rotation":0},{"Text":"ARGPTR","TextBB":[101.887,147.772,134.842,154.745],"Rotation":0},{"Text":"=","TextBB":[138.231,146.342,146.725,154.943],"Rotation":0},{"Text":"a","TextBB":[149.875,146.342,155.88,154.943],"Rotation":0},{"Text":"1","TextBB":[155.876,149.646,160.588,155.789],"Rotation":0},{"Text":"]","TextBB":[161.278,146.342,164.406,154.943],"Rotation":0},{"Text":"∧","TextBB":[82.9667,156.869,90.425,166.012],"Rotation":0},{"Text":"[∗(","TextBB":[92.8444,157.411,105.966,166.012],"Rotation":0},{"Text":"ARGPTR","TextBB":[106.212,158.841,139.167,165.815],"Rotation":0},{"Text":"+","TextBB":[141.925,157.411,150.42,166.012],"Rotation":0},{"Text":"1)","TextBB":[152.938,157.411,162.779,166.012],"Rotation":0},{"Text":"=","TextBB":[165.927,157.411,174.422,166.012],"Rotation":0},{"Text":"a","TextBB":[177.572,157.411,183.578,166.012],"Rotation":0},{"Text":"2","TextBB":[183.575,160.716,188.286,166.859],"Rotation":0},{"Text":"]","TextBB":[188.975,157.411,192.104,166.012],"Rotation":0},{"Text":"∧","TextBB":[82.9667,167.938,90.425,177.082],"Rotation":0},{"Text":"[∗(","TextBB":[92.8444,168.481,105.966,177.082],"Rotation":0},{"Text":"ARGPTR","TextBB":[106.212,169.91,139.167,176.884],"Rotation":0},{"Text":"+","TextBB":[141.925,168.481,150.42,177.082],"Rotation":0},{"Text":"2)","TextBB":[152.938,168.481,162.779,177.082],"Rotation":0},{"Text":"=","TextBB":[165.927,168.481,174.422,177.082],"Rotation":0},{"Text":"a","TextBB":[177.572,168.481,183.578,177.082],"Rotation":0},{"Text":"3","TextBB":[183.575,171.785,188.286,177.928],"Rotation":0},{"Text":"]","TextBB":[188.975,168.481,192.104,177.082],"Rotation":0},{"Text":"∧","TextBB":[82.9667,179.008,90.425,188.151],"Rotation":0},{"Text":"[∗(","TextBB":[92.8444,179.55,105.966,188.151],"Rotation":0},{"Text":"ARGPTR","TextBB":[106.212,180.98,139.167,187.954],"Rotation":0},{"Text":"+","TextBB":[141.925,179.55,150.42,188.151],"Rotation":0},{"Text":"3)","TextBB":[152.938,179.55,162.779,188.151],"Rotation":0},{"Text":"=","TextBB":[165.927,179.55,174.422,188.151],"Rotation":0},{"Text":"a","TextBB":[177.572,179.55,183.578,188.151],"Rotation":0},{"Text":"4","TextBB":[183.575,182.854,188.286,188.998],"Rotation":0},{"Text":"]","TextBB":[188.975,179.55,192.104,188.151],"Rotation":0},{"Text":"∧","TextBB":[82.9667,190.077,90.425,199.221],"Rotation":0},{"Text":"[","TextBB":[92.8444,190.62,95.9731,199.221],"Rotation":0},{"Text":"MODE","TextBB":[96.2194,192.049,120.473,199.023],"Rotation":0},{"Text":"=","TextBB":[123.854,190.62,132.349,199.221],"Rotation":0},{"Text":"printing]","TextBB":[135.499,190.726,169.302,199.444],"Rotation":0},{"Text":"(B)","TextBB":[274.225,77.7899,287.137,86.5074],"Rotation":0},{"Text":"Bad","TextBB":[289.558,78.313,306.993,85.9263],"Rotation":0},{"Text":"for","TextBB":[309.414,77.7899,320.708,86.5074],"Rotation":0},{"Text":"Write","TextBB":[323.129,77.7899,345.185,86.5074],"Rotation":0},{"Text":"Exploit","TextBB":[347.606,77.7899,376.132,86.5074],"Rotation":0},{"Text":"[","TextBB":[249.937,90.9931,253.066,99.5944],"Rotation":0},{"Text":"FMTPTR","TextBB":[253.312,92.423,285.841,99.3967],"Rotation":0},{"Text":"<","TextBB":[289.229,90.9931,297.879,99.5944],"Rotation":0},{"Text":"DIS","TextBB":[301.269,91.0997,317.842,99.8172],"Rotation":0},{"Text":"+","TextBB":[320.748,91.0997,326.211,99.8172],"Rotation":0},{"Text":"(LEN","TextBB":[329.117,91.0997,352.625,99.8172],"Rotation":0},{"Text":"−","TextBB":[355.287,90.4507,363.937,99.5944],"Rotation":0},{"Text":"1)","TextBB":[366.599,91.0997,375.151,99.8172],"Rotation":0},{"Text":"−","TextBB":[377.815,90.4507,386.465,99.5944],"Rotation":0},{"Text":"1]","TextBB":[389.126,91.0997,397.34,99.8172],"Rotation":0},{"Text":"∧","TextBB":[249.938,101.52,257.396,110.664],"Rotation":0},{"Text":"[","TextBB":[259.815,102.063,262.944,110.664],"Rotation":0},{"Text":"ARGPTR","TextBB":[263.19,103.492,296.145,110.466],"Rotation":0},{"Text":">","TextBB":[299.533,102.063,308.183,110.664],"Rotation":0},{"Text":"DIS]","TextBB":[311.574,102.169,331.516,110.887],"Rotation":0},{"Text":"∧","TextBB":[249.938,112.59,257.396,121.733],"Rotation":0},{"Text":"[","TextBB":[259.815,113.132,262.944,121.733],"Rotation":0},{"Text":"ARGPTR","TextBB":[263.19,114.562,296.145,121.536],"Rotation":0},{"Text":"<","TextBB":[299.533,113.132,308.183,121.733],"Rotation":0},{"Text":"DIS","TextBB":[311.574,113.239,328.147,121.956],"Rotation":0},{"Text":"+","TextBB":[331.052,113.239,336.515,121.956],"Rotation":0},{"Text":"(LEN","TextBB":[339.421,113.239,362.929,121.956],"Rotation":0},{"Text":"−","TextBB":[365.592,112.59,374.241,121.733],"Rotation":0},{"Text":"1)","TextBB":[376.903,113.239,385.456,121.956],"Rotation":0},{"Text":"−","TextBB":[388.119,112.59,396.769,121.733],"Rotation":0},{"Text":"4]","TextBB":[399.431,113.239,407.645,121.956],"Rotation":0},{"Text":"∧","TextBB":[249.938,123.66,257.396,132.804],"Rotation":0},{"Text":"[∗","TextBB":[259.815,124.203,268.615,132.804],"Rotation":0},{"Text":"FMTPTR","TextBB":[268.86,125.633,301.388,132.606],"Rotation":0},{"Text":"=","TextBB":[304.776,124.203,313.271,132.804],"Rotation":0},{"Text":"\u2018%\u2019]","TextBB":[316.421,124.832,336.984,132.446],"Rotation":0},{"Text":"∧","TextBB":[249.938,134.73,257.396,143.874],"Rotation":0},{"Text":"[∗(","TextBB":[259.815,135.272,272.938,143.874],"Rotation":0},{"Text":"FMTPTR","TextBB":[273.183,136.702,305.712,143.676],"Rotation":0},{"Text":"+","TextBB":[308.471,135.272,316.966,143.874],"Rotation":0},{"Text":"1)","TextBB":[319.484,135.272,329.325,143.874],"Rotation":0},{"Text":"=","TextBB":[332.473,135.272,340.968,143.874],"Rotation":0},{"Text":"\u2018n\u2019]","TextBB":[344.118,135.902,364.681,143.515],"Rotation":0},{"Text":"∧","TextBB":[249.938,145.799,257.396,154.943],"Rotation":0},{"Text":"[∗","TextBB":[259.815,146.342,268.615,154.943],"Rotation":0},{"Text":"ARGPTR","TextBB":[268.86,147.772,301.815,154.745],"Rotation":0},{"Text":"=","TextBB":[305.203,146.342,313.697,154.943],"Rotation":0},{"Text":"a","TextBB":[316.847,146.342,322.853,154.943],"Rotation":0},{"Text":"1","TextBB":[322.849,149.646,327.56,155.789],"Rotation":0},{"Text":"]","TextBB":[328.249,146.342,331.377,154.943],"Rotation":0},{"Text":"∧","TextBB":[249.938,156.869,257.396,166.012],"Rotation":0},{"Text":"[∗(","TextBB":[259.815,157.411,272.938,166.012],"Rotation":0},{"Text":"ARGPTR","TextBB":[273.183,158.841,306.138,165.815],"Rotation":0},{"Text":"+","TextBB":[308.897,157.411,317.392,166.012],"Rotation":0},{"Text":"1)","TextBB":[319.91,157.411,329.742,166.012],"Rotation":0},{"Text":"=","TextBB":[332.899,157.411,341.394,166.012],"Rotation":0},{"Text":"a","TextBB":[344.544,157.411,350.55,166.012],"Rotation":0},{"Text":"2","TextBB":[350.546,160.716,355.257,166.859],"Rotation":0},{"Text":"]","TextBB":[355.947,157.411,359.076,166.012],"Rotation":0},{"Text":"∧","TextBB":[249.938,167.938,257.396,177.082],"Rotation":0},{"Text":"[∗(","TextBB":[259.815,168.481,272.938,177.082],"Rotation":0},{"Text":"ARGPTR","TextBB":[273.183,169.91,306.138,176.884],"Rotation":0},{"Text":"+","TextBB":[308.897,168.481,317.392,177.082],"Rotation":0},{"Text":"2)","TextBB":[319.91,168.481,329.742,177.082],"Rotation":0},{"Text":"=","TextBB":[332.899,168.481,341.394,177.082],"Rotation":0},{"Text":"a","TextBB":[344.544,168.481,350.55,177.082],"Rotation":0},{"Text":"3","TextBB":[350.546,171.785,355.257,177.928],"Rotation":0},{"Text":"]","TextBB":[355.947,168.481,359.076,177.082],"Rotation":0},{"Text":"∧","TextBB":[249.938,179.008,257.396,188.151],"Rotation":0},{"Text":"[∗(","TextBB":[259.815,179.55,272.938,188.151],"Rotation":0},{"Text":"ARGPTR","TextBB":[273.185,180.98,306.14,187.954],"Rotation":0},{"Text":"+","TextBB":[308.897,179.55,317.392,188.151],"Rotation":0},{"Text":"3)","TextBB":[319.91,179.55,329.751,188.151],"Rotation":0},{"Text":"=","TextBB":[332.899,179.55,341.394,188.151],"Rotation":0},{"Text":"a","TextBB":[344.544,179.55,350.55,188.151],"Rotation":0},{"Text":"4","TextBB":[350.546,182.854,355.257,188.998],"Rotation":0},{"Text":"]","TextBB":[355.947,179.55,359.076,188.151],"Rotation":0},{"Text":"∧","TextBB":[249.938,190.077,257.396,199.221],"Rotation":0},{"Text":"[","TextBB":[259.815,190.62,262.944,199.221],"Rotation":0},{"Text":"DONE","TextBB":[263.19,192.049,286.142,199.023],"Rotation":0},{"Text":"=","TextBB":[289.528,190.62,298.022,199.221],"Rotation":0},{"Text":"WRITEVAL","TextBB":[301.414,192.049,344.171,199.023],"Rotation":0},{"Text":"]","TextBB":[344.408,190.62,347.537,199.221],"Rotation":0},{"Text":"∧","TextBB":[249.937,201.147,257.396,210.29],"Rotation":0},{"Text":"[","TextBB":[259.815,201.689,262.944,210.29],"Rotation":0},{"Text":"MODE","TextBB":[263.19,203.119,287.443,210.093],"Rotation":0},{"Text":"=","TextBB":[290.826,201.689,299.321,210.29],"Rotation":0},{"Text":"printing]","TextBB":[302.469,201.795,336.273,210.513],"Rotation":0}],"Mention":["counts the number of bytes that have been output by this call on\nprintf. Figure 4(B) shows the case where an attacker writes the\n","the argument at ARGPTR as a pointer and prints the contents of\nthe memory location specified by the pointer as a string, which\nwould let the attacker achieve his goal. This is formalized using\nthe predicate Bad shown in Figure 4(A). Also, note that:\n","The main message of this paper is that it is necessary to model\nlow-level details of a software component\u2019s implementation in or-\nder to find exploits against it. We demonstrated this by considering\nAPI-level exploits, and presented a framework to model and ana-\nlyze APIs for exploits. We also showed the use of the framework\nby considering two real-world APIs of significant complexity. We\nbriefly discuss some difficulties we encountered while modeling\nand analyzing APIs:\nModeling low-level details. As demonstrated by our case studies,\ndifferent APIs can be exploited in different ways. Thus, the main\nproblem is to identify the low-level details to model for each API.\nOne possible solution is to model each API operation at the bit-level\n[11, 40], i.e., how each bit in the system is affected by applying\nthe API operation. While this approach may solve the problem of\nidentifying appropriate low-details for each API, it may not scale.\nWe expect that, as with each of our case studies, the use of domain-\nspecific expertise is the best solution to identify appropriate low-\nlevel details for each API.\nConstructing the predicate Bad. Consider Figure 4: We used the\nfact that a \"%s\" can be used to read from a memory location. Con-\nsequently, the exploits found by our tool followed this blueprint.\nWhile this covers a large class of exploits, there may be other ways\nto read from memory, which our tool will miss. As before, domain-\nspecific expertise is needed to construct an appropriate predicate\nBad that covers a large class of exploits.\nAutomating model construction. The models of printf and the\nIBM CCA API were constructed manually by examining source\ncode, and studying their manuals. This is clearly a tedious and\nerror-prone process. Modern software model checkers [3, 21] auto-\nmatically construct finite-state models using predicate abstraction.\nIn our case, the main obstacles to automatic model construction are\ntwofold: (1) low-level details to be modeled are domain-specific,\nand (2) the resulting model is often infinite-state (e.g., Section 4).\nIn future work, we intend to investigate techniques, that, given the\nset of low-level details to be modeled, automatically extract models\namenable for exploit-analysis.\n"],"Page":6,"Number":4,"Type":"Figure","CaptionBB":[73,217,407,245],"Height":1100,"Width":850,"DPI":100,"ImageBB":[72,74,411,215]}